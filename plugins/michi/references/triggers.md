# Michi スキル - 発動トリガー一覧

このドキュメントは、Michiスキルが自動発動するトリガーキーワードとワークフローフェーズの一覧です。

## 目次

- [キーワードトリガー](#キーワードトリガー)
- [ワークフローフェーズトリガー](#ワークフローフェーズトリガー)
- [ハイブリッドトリガー](#ハイブリッドトリガー)

---

## キーワードトリガー

Claude がユーザーの発言に以下のキーワードを検出すると、対応する機能を自動発動または提案します。

### プロジェクト管理

| キーワード | 発動機能 |
|----------|---------|
| 「新しいプロジェクトを開始」「仕様を初期化」「プロジェクト作成」 | launch-pj |
| 「進捗を確認」「ステータスを表示」「現在の状況は？」 | show-status |
| 「プロジェクトをアーカイブ」「完了したのでアーカイブ」 | archive-pj |
| 「プロジェクトを切り替え」「別のプロジェクトに」 | switch-pj |

### 仕様作成

| キーワード | 発動機能 |
|----------|---------|
| 「要件定義したい」「要件を作成」「要求仕様」 | create-requirements |
| 「設計書を作成」「アーキテクチャを設計」「設計を開始」 | create-design |
| 「マスタードキュメントを更新」 | update-master-docs |

### テスト計画

| キーワード | 発動機能 |
|----------|---------|
| 「テスト計画を立てたい」「テスト戦略」「テスト仕様」 | plan-tests |

### 開発実行

| キーワード | 発動機能 |
|----------|---------|
| 「タスクに分割」「タスク一覧を作成」「実装タスク」 | create-tasks |
| 「実装したい」「TDDで実装」「開発を開始」 | dev |

### レビュー・検証

| キーワード | 発動機能 |
|----------|---------|
| 「設計をレビュー」「設計の妥当性を確認」 | review-design |
| 「実装を検証」「コードをレビュー」 | review-dev |
| 「Gap分析」「既存コードとの差分」 | analyze-gap |

### マルチリポジトリ

| キーワード | 発動機能 |
|----------|---------|
| 「マルチリポジトリプロジェクト」「複数リポジトリ」 | multi-repo:launch-pj |
| 「マルチリポの要件定義」 | multi-repo:create-requirements |
| 「マルチリポの設計」 | multi-repo:create-design |
| 「クロスリポ検証」「クロスリポジトリ整合性」 | multi-repo:review-cross |
| 「各リポジトリに仕様を展開」 | multi-repo:propagate |
| 「全リポジトリで実装」「並行実装」 | multi-repo:dev-all |

---

## ワークフローフェーズトリガー

Claude は `project.json` のフェーズ情報を参照して、次のステップを自動提案します。

| 現在のフェーズ | phase値 | 次のステップ提案 |
|-------------|--------|--------------|
| プロジェクト初期化完了 | `initialized` | 要件定義（create-requirements） |
| 要件定義完了 | `requirements-generated` | 設計（create-design） |
| 設計完了 | `design-generated` | テスト計画（plan-tests）またはタスク分割（create-tasks） |
| タスク分割完了 | `tasks-generated` | TDD実装（dev） |
| 実装完了 | `implementation-complete` | アーカイブ（archive-pj） |

### project.json の例

```json
{
  "name": "20260115-user-auth",
  "description": "ユーザー認証機能",
  "created_at": "2026-01-15T10:00:00Z",
  "updated_at": "2026-01-15T11:00:00Z",
  "phase": "requirements-generated",
  "approvals": {
    "requirements": { "approved": true, "generated": true },
    "design": { "approved": false, "generated": false },
    "tasks": { "approved": false, "generated": false }
  }
}
```

上記の例では、Claude は「次は設計フェーズに進みますか？」と提案します。

---

## ハイブリッドトリガー

Claude は **キーワード** と **ワークフローフェーズ** の両方を考慮して、柔軟に発動を判断します。

### 例1: キーワード + フェーズ

**ユーザー**: 「要件定義したい」（キーワード）

**project.json**: `phase: "initialized"`（ワークフローフェーズ）

**Claude の動作**: create-requirements を自動実行

---

### 例2: フェーズのみ

**ユーザー**: 「次に進みたい」（具体的なキーワードなし）

**project.json**: `phase: "requirements-generated"`（ワークフローフェーズ）

**Claude の動作**: 「次は設計フェーズに進みますか？」と提案

---

### 例3: キーワードのみ

**ユーザー**: 「設計書を作成」（キーワード）

**project.json**: 存在しない

**Claude の動作**: 「まずプロジェクトを初期化しますか？」と提案

---

## トリガーの優先順位

1. **明示的な発動**（`/michi [サブコマンド]`）: 最優先
2. **キーワードトリガー**: 高優先
3. **ワークフローフェーズトリガー**: 中優先
4. **コンテキスト推測**: 低優先（Claude が文脈から判断）

---

## 発動条件のカスタマイズ

現在、発動条件のカスタマイズはサポートされていませんが、以下の方法で制御できます：

### 1. 明示的な発動を使用

自動発動を避けたい場合は、常に `/michi [サブコマンド]` 形式で明示的に呼び出します。

### 2. project.json のフェーズを手動管理

自動提案を避けたい場合は、project.json のフェーズを手動で管理します。

---

## まとめ

Michiスキルは、キーワードトリガーとワークフローフェーズトリガーを組み合わせたハイブリッド発動により、柔軟な自動化を実現します。

詳細については、以下のドキュメントを参照してください：

- **command-reference.md**: 全19機能の詳細リファレンス
- **workflow-guide.md**: 開発ワークフローの全体説明
- **multi-repo-guide.md**: マルチリポジトリ開発の詳細
- **examples.md**: 使用例・ユースケース
