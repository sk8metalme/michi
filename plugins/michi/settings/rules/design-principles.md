# 設計原則

このドキュメントは、Michiの設計フェーズで遵守すべき原則を定義します。

## 型安全性

### プロジェクトの技術スタックに整合した強い型付けを強制

- **静的型付け言語の場合**:
  - 明示的な型/インターフェースを定義
  - 安全でないキャストを避ける
  - 型推論を活用しつつ、公開インターフェースは明示的に型付け

- **TypeScript**:
  - `any`を決して使用しない
  - 正確な型とジェネリクスを優先
  - strictモードを有効化
  - Union TypesとDiscriminated Unionsを活用

- **動的型付け言語の場合**:
  - 型ヒント/アノテーションを提供（例: Python型ヒント）
  - 境界で入力を検証
  - ドキュメンテーション文字列で型情報を明記

### コンポーネント間の型安全性

- パブリックインターフェースとコントラクトを明確に文書化
- API境界での型チェックを徹底
- データ変換時の型保証を明示

## 視覚的コミュニケーション

### Mermaid図の活用

複雑なアーキテクチャには、以下のような視覚的な図を含める:
- アーキテクチャ図（C4モデル）
- シーケンス図
- クラス図
- ER図（データモデル）
- フローチャート（複雑なロジック）

### 図の品質基準

- シンプルで理解しやすい
- 重要な情報のみを含む（詳細すぎない）
- 一貫した表記法を使用
- 図と文章の補完関係を意識

## フォーマルトーン

### ドキュメントのトーン

- 簡潔で明確な表現
- 専門用語の適切な使用
- 曖昧さを排除
- 客観的な記述

### 避けるべき表現

- 「おそらく」「たぶん」など推測を示す表現
- 過度に口語的な表現
- 感情的な表現

## アーキテクチャ決定

### 技術選定の根拠

技術選定には以下を明記:
- 選定理由
- 代替案との比較
- トレードオフの考察
- プロジェクトコンテキストとの整合性

### パターン選択の透明性

- 選択したデザインパターンの説明
- なぜそのパターンが適切かの根拠
- パターン適用による効果

## マスタードキュメント整合

### 既存パターンの尊重

- マスタードキュメントコンテキストを確認
- 既存のアーキテクチャパターンを踏襲
- 新規パターン導入時は正当化

### プロジェクト標準の遵守

- コーディング規約
- アーキテクチャガイドライン
- 技術スタック制約

## 設計フォーカス

### アーキテクチャとインターフェースのみ

- 実装の詳細（コード）は含めない
- インターフェース定義を中心に記述
- コンポーネント間の責務と境界を明確化

### 適切な抽象度

- 高レベルすぎず、低レベルすぎず
- 実装可能なレベルの詳細度
- タスク生成に十分な情報を提供

## 要件トレーサビリティ

### 要件IDの使用

- requirements.mdで定義された数値要件IDのみを使用（例: "1.1", "1.2", "3.1"）
- 新しいIDを発明しない
- アルファベットラベルを使用しない

### 要件との対応関係

- 各設計要素が対応する要件IDを明記
- 要件の漏れがないことを確認
- 要件以外の設計決定は正当化
